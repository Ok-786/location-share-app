(this["webpackJsonplocation-share-app"]=this["webpackJsonplocation-share-app"]||[]).push([[0],{13:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var c=n(0),a=Object(c.createContext)({isLoggedIn:!1,userId:null,token:null,login:function(){},logout:function(){}})},21:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var c=n(12),a=n.n(c),r=n(14),o=n(10),s=n(0),i=function(){var e=Object(s.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(s.useState)(),l=Object(o.a)(i,2),u=l[0],j=l[1],d=Object(s.useRef)([]),b=Object(s.useCallback)(function(){var e=Object(r.a)(a.a.mark((function e(t){var n,r,o,s,i,l,u=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:"GET",r=u.length>2&&void 0!==u[2]?u[2]:null,o=u.length>3&&void 0!==u[3]?u[3]:{},e.prev=3,c(!0),s=new AbortController,d.current.push(s),e.next=9,fetch(t,{method:n,body:r,headers:o,signal:s.signal});case 9:return i=e.sent,e.next=12,i.json();case 12:if(l=e.sent,d.current=d.current.filter((function(e){return e!==s})),i.ok){e.next=16;break}throw new Error(l.message);case 16:return c(!1),e.abrupt("return",l);case 20:throw e.prev=20,e.t0=e.catch(3),j(e.t0.message),c(!1),e.t0;case 25:case"end":return e.stop()}}),e,null,[[3,20]])})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(s.useEffect)((function(){return function(){d.current.forEach((function(e){return e.abort()}))}}),[]),{isLoading:n,error:u,sendRequest:b,clearError:function(){j(null)}}}},22:function(e,t,n){"use strict";n(0),n(53);var c=n(1);t.a=function(e){return Object(c.jsx)("div",{className:"".concat(e.asOverlay&&"loading-spinner__overlay"),children:Object(c.jsx)("div",{className:"lds-dual-ring"})})}},25:function(e,t,n){"use strict";n(0);var c=n(9),a=n.n(c),r=(n(50),n(1));t.a=function(e){return a.a.createPortal(Object(r.jsx)("div",{className:"backdrop",onClick:e.onClick}),document.getElementById("backdrop-hook"))}},26:function(e,t,n){"use strict";n(0),n(51);var c=n(1);t.a=function(e){return Object(c.jsx)("div",{className:"card ".concat(e.className),style:e.style,children:e.children})}},37:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var c=n(9),a=n.n(c),r=n(0),o=n.n(r),s=n(3),i=n(8),l=n(19),u=n(20),j=n(24),d=n(23),b=(n(37),n(1)),h=function(e){return Object(b.jsx)("header",{className:"main-header",children:e.children})},O=(n(39),n(40),n(13));function p(e){var t=Object(r.useContext)(O.a);return Object(b.jsxs)("ul",{className:"nav-links",children:[Object(b.jsx)("li",{children:Object(b.jsx)(i.c,{to:"/",exact:!0,children:"All USERS"})}),t.isLoggedIn&&Object(b.jsxs)(o.a.Fragment,{children:[Object(b.jsx)("li",{children:Object(b.jsx)(i.c,{to:"/".concat(t.userId,"/places"),children:"MY PLACES"})}),Object(b.jsx)("li",{children:Object(b.jsx)(i.c,{to:"/places/new",children:"ADD PLACE"})})]}),!t.isLoggedIn&&Object(b.jsx)("li",{children:Object(b.jsx)(i.c,{to:"/auth",children:"AUTHENTICATE"})}),t.isLoggedIn&&Object(b.jsx)("li",{children:Object(b.jsx)(i.c,{to:"/auth",onClick:t.logout,children:"LOGOUT"})})]})}n(49);var f=n(57),x=function(e){var t=Object(b.jsx)(f.a,{in:e.show,timeout:200,classNames:"slide-in-left",mountOnEnter:!0,unmountOnExit:!0,children:Object(b.jsx)("aside",{className:"side-drawer",onClick:e.onClick,children:e.children})});return a.a.createPortal(t,document.getElementById("drawer-hook"))},m=n(25);function v(e){var t=e.drawerIsOpen,n=e.openDrawerHandler,c=e.closeDrawerHandler;return Object(b.jsxs)(o.a.Fragment,{children:[t&&Object(b.jsx)(m.a,{onClick:c}),Object(b.jsx)(x,{show:t,onClick:c,children:Object(b.jsx)("nav",{className:"main-navigation__drawwer-nav",children:Object(b.jsx)(p,{})})}),Object(b.jsxs)(h,{children:[Object(b.jsxs)("button",{className:"main-navigation__menu-btn",onClick:n,children:[Object(b.jsx)("span",{}),Object(b.jsx)("span",{}),Object(b.jsx)("span",{})]}),Object(b.jsx)("h1",{className:"main-navigation__title",children:Object(b.jsx)(i.b,{to:"/",children:"YourPlaces"})}),Object(b.jsx)("nav",{className:"main-navigation__header-nav",children:Object(b.jsx)(p,{})})]})]})}var g,k=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(l.a)(this,n);for(var c=arguments.length,a=new Array(c),r=0;r<c;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={drawerIsOpen:!1},e.openDrawerHandler=function(){e.setState({drawerIsOpen:!0})},e.closeDrawerHandler=function(){e.setState({drawerIsOpen:!1})},e}return Object(u.a)(n,[{key:"render",value:function(e){return Object(b.jsx)(v,{drawerIsOpen:this.state.drawerIsOpen,openDrawerHandler:this.openDrawerHandler,closeDrawerHandler:this.closeDrawerHandler})}}]),n}(r.Component),w=n(10),I=n(26);function y(){return Object(b.jsx)("div",{className:"center",children:Object(b.jsx)(I.a,{children:Object(b.jsx)("h3",{children:"Mail has been sent to your email, kindly verify it to proceed!"})})})}var S=n(12),D=n.n(S),N=n(14),C=n(21),E=function(){var e=Object(C.a)().sendRequest,t=Object(r.useContext)(O.a);return Object(r.useEffect)((function(){(function(){var n=Object(N.a)(D.a.mark((function n(){var c,a,r;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=null,n.prev=1,console.log("im in"),a=JSON.parse(localStorage.getItem("authData")),console.log(a),!a){n.next=23;break}return r=null,console.log(c),c={userId:a.userId,token:a.token,confirmed:!0},console.log(c),n.prev=10,n.next=13,e("".concat("https://location-app-s.herokuapp.com/api","/users/auth"),"POST",JSON.stringify({userId:a.userId,token:a.token,confirmed:a.confirmed}),{"Content-Type":"application/json"});case 13:r=n.sent,n.next=19;break;case 16:n.prev=16,n.t0=n.catch(10),console.log(n.t0);case 19:localStorage.removeItem("authData"),console.log("im innnnn"),console.log(r.userId+"   11111111"),t.login(r.userId,r.token);case 23:n.next=28;break;case 25:n.prev=25,n.t1=n.catch(1),console.log("adadasd"+n.t1);case 28:case"end":return n.stop()}}),n,null,[[1,25],[10,16]])})));return function(){return n.apply(this,arguments)}})()()}),[e]),Object(b.jsx)("div",{children:"email verified!"})},T=n(22),_=o.a.lazy((function(){return n.e(6).then(n.bind(null,130))})),H=o.a.lazy((function(){return n.e(5).then(n.bind(null,131))})),L=o.a.lazy((function(){return Promise.all([n.e(3),n.e(8)]).then(n.bind(null,129))})),P=o.a.lazy((function(){return Promise.all([n.e(9),n.e(7)]).then(n.bind(null,126))})),A=o.a.lazy((function(){return n.e(4).then(n.bind(null,127))}));function J(){var e,t=function(){var e=Object(r.useState)(!1),t=Object(w.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(),o=Object(w.a)(a,2),s=o[0],i=o[1],l=Object(r.useState)(),u=Object(w.a)(l,2),j=u[0],d=u[1],b=Object(r.useCallback)((function(e,t,n){c(t),i(e);var a=n||new Date((new Date).getTime()+36e5);d(a),console.log(a),localStorage.setItem("userData",JSON.stringify({expiration:a,userId:e,token:t}))}),[]),h=Object(r.useCallback)((function(){c(null),i(null),d(null),localStorage.clear()}),[]);return Object(r.useEffect)((function(){if(n&&j){var e=j.getTime()-(new Date).getTime();g=setTimeout(h,e)}else clearTimeout(g)}),[n,h,j]),Object(r.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));console.log(e),e&&e.token&&new Date(e.expiration)>new Date&&b(e.userId,e.token,new Date(e.expiration))}),[b]),{token:n,login:b,logout:h,userId:s}}(),n=t.token,c=t.login,a=t.logout,o=t.userId,l=JSON.parse(localStorage.getItem("authData"));return e=n?Object(b.jsxs)(s.d,{children:[Object(b.jsx)(s.b,{path:"/auth/verified",component:E,exact:!0}),Object(b.jsx)(s.b,{path:"/",component:_,exact:!0}),Object(b.jsx)(s.b,{path:"/:userId/places",component:L,exact:!0}),Object(b.jsx)(s.b,{path:"/places/new",component:H,exact:!0}),Object(b.jsx)(s.b,{path:"/places/:placeId",component:P,exact:!0}),Object(b.jsx)(s.a,{to:"/"})]}):Object(b.jsxs)(s.d,{children:[Object(b.jsx)(s.b,{path:"/auth/verified",component:E,exact:!0}),Object(b.jsx)(s.b,{path:"/auth/activate",component:y,exact:!0}),Object(b.jsx)(s.b,{path:"/",component:_,exact:!0}),Object(b.jsx)(s.b,{path:"/:userId/places",component:L,exact:!0}),Object(b.jsx)(s.b,{path:"/auth",component:A,exact:!0}),l?Object(b.jsx)(s.a,{to:"/auth/Verified"}):Object(b.jsx)(s.a,{to:"/auth"})]}),Object(b.jsx)(O.a.Provider,{value:{isLoggedIn:!!n,token:n,userId:o,login:c,logout:a},children:Object(b.jsxs)(i.a,{children:[Object(b.jsx)(k,{}),Object(b.jsx)("main",{children:Object(b.jsx)(r.Suspense,{fallback:Object(b.jsx)("div",{className:"center",children:Object(b.jsx)(T.a,{})}),children:e})})]})})}n(54);a.a.render(Object(b.jsx)(J,{}),document.querySelector("#root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.e64024d0.chunk.js.map